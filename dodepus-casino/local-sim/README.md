# Local Simulation Layer

Этот каталог содержит все утилиты, которые обеспечивают офлайн-симуляцию бэкенда с использованием `localStorage` и встроенной SQL-подобной базы данных `local-sim/database`.

## Карта каталогов

- `auth/` — пользовательская часть симулятора.
  - `api.js` — основной «локальный API», который управляет пользователями и сессией в `localStorage`.
  - `accounts/` — сиды пользователей и функции заполнения хранилища для моковой авторизации.
  - `profileActions.js` — мутации пользовательского профиля, которые обновляют локальное хранилище и возвращают свежие данные для UI.
  - `composeUser.js` — объединяет записи пользователя с локальными экстрас.
  - `session/` — инициализация сессии и синхронизация вкладок.
- `admin/` — административные сценарии симулятора.
  - `features/` — функциональные модули, которые напрямую соответствуют страницам админ-панели (`clients`, `promo`, `transactions`, `verification`, `access`, `communications`, `monitoring`). Каждый модуль инкапсулирует сиды, бизнес-правила и события для UI.
  - `logs/` — набор хелперов для журналирования действий в админке.
  - `shared/` — общие хранилища и утилиты, разделяемые административными сценариями.
- `modules/` — тематические блоки поверх SQL-ядра. Сейчас выделен модуль `verification/`:
  - `helpers.js` — нормализаторы статусов, полей и заметок запросов.
  - `storage.js` — чтение и запись снапшотов верификации через `profileExtras` и локальную БД.
  - `seed.js` — подготовка сид-данных верификации для аккаунтов.
  - `api.js` — экспорт общих действий для профиля и админки (листинг запросов, подписки, обновления статусов).
- `database/` — SQL-подобный движок с персистентностью в `localStorage`, единая точка для мок-таблиц (`auth_users`, `profiles`, `verification_requests`, `verification_uploads`, `admin_logs`).

## Как читать структуру

- **База (`database/`)** — имитирует Supabase/Postgres: схема и сиды создают таблицы пользователей, профилей, заявок, загрузок документов и журналов.
- **Пользовательские сценарии (`auth/`)** — всё, что видит клиент: авторизация, профиль, баланс, загрузка документов, управление сессиями.
- **Админские сценарии (`admin/`)** — отражение кабинета администратора: списки клиентов, роли, логи, верификация, мониторинг.
- **Модули (`modules/verification/`)** — общий слой для обеих сторон. Здесь лежат нормализаторы статусов, генераторы сидов, работа со снапшотами и экспорт API для UI.

Такое деление позволяет быстро заменить локальную симуляцию на реальный SQL-бэкенд: достаточно переписать слой `database/` и адаптеры модулей, не трогая остальной код.

Компоненты внутри `src/` импортируют функции напрямую из каталога `local-sim`, чтобы вся логика, связанная с локальным хранилищем, была собрана в одном месте рядом с кодом интерфейса.
